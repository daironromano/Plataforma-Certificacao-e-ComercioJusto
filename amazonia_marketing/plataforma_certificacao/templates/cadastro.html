{% extends 'base.html' %}

{% block title %}Criar Conta{% endblock %}

{% block content %}

<div style="max-width: 500px; margin: 40px auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1);">
    
    <h2 style="color: var(--verde-amazonia); text-align: center; margin-bottom: 20px;">Crie sua Conta</h2>

    <form method="POST">
        
        {% csrf_token %}
        
        {% for field in form %}
            <div style="margin-bottom: 15px;">
                
                <label style="font-weight: bold; display: block; margin-bottom: 5px; color: #333;">
                    {{ field.label }} </label>
                
                {{ field }}
                
                {% if field.errors %}
                    <div style="color: red; font-size: 0.85rem; margin-top: 5px;">
                        {{ field.errors }}
                    </div>
                {% endif %}
                
                {% if field.help_text %}
                    <small style="color: #666; display: block;">{{ field.help_text }}</small>
                {% endif %}
            </div>
        {% endfor %}

        <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 10px;">
            Criar Conta
        </button>
    </form>

    <div style="text-align: center; margin-top: 20px; border-top: 1px solid #eee; padding-top: 15px;">
        <p>Já tem uma conta?</p>
        <a href="{% url 'login' %}" style="color: var(--verde-amazonia); font-weight: bold;">Fazer Login</a>
    </div>
</div>

<script>
    // Espera o HTML carregar todo antes de tentar buscar os elementos (evita erros de "null")
    document.addEventListener('DOMContentLoaded', function() {
        
        // 1. SELETORES:
        // Buscamos os botões de rádio pelo valor.
        // O seletor CSS 'input[value="produtor"]' acha o input que tem esse valor específico.
        const radioProdutor = document.querySelector('input[value="produtor"]');
        const radioEmpresa = document.querySelector('input[value="empresa"]');
        
        // 2. BUSCANDO OS CAMPOS DE CPF/CNPJ:
        // 'id_cpf' e 'id_cnpj' são nomes padrões que o Django dá para os campos.
        // O .closest('div') é um truque genial: ele sobe na árvore do HTML até achar
        // a <div style="margin-bottom: 15px;"> que envolve o input.
        // Fazemos isso para esconder TUDO (o input, o label e a mensagem de erro) de uma vez só.
        const divCpf = document.getElementById('id_cpf').closest('div'); 
        const divCnpj = document.getElementById('id_cnpj').closest('div');

        // 3. A FUNÇÃO DE LÓGICA:
        function alternarCampos() {
            if (radioEmpresa.checked) {
                // Se "Empresa" está marcado:
                divCnpj.style.display = 'block'; // Mostra a div do CNPJ
                divCpf.style.display = 'none';   // Esconde a div do CPF
            } else {
                // Se "Produtor" está marcado (ou nenhum, padrão):
                divCpf.style.display = 'block';  // Mostra a div do CPF
                divCnpj.style.display = 'none';  // Esconde a div do CNPJ
            }
        }

        // 4. ESCUTADORES DE EVENTO (Event Listeners):
        // Ficam vigiando: "Quando o usuário MUDAR (change) esse botão, rode a função alternarCampos".
        radioProdutor.addEventListener('change', alternarCampos);
        radioEmpresa.addEventListener('change', alternarCampos);

        // 5. ESTADO INICIAL:
        // Rodamos a função uma vez logo que a página abre. 
        // Isso garante que o campo certo já comece aparecendo/escondido, 
        // mesmo se o navegador tiver salvo a escolha anterior do usuário.
        alternarCampos();
    });
</script>
{% endblock %}